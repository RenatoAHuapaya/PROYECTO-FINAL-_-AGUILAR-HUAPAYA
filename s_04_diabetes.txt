---
title: "Análisis de s04_diabetes"
author: "Generated by ChatGPT"
date: "`r Sys.Date()`"
format: html
execute:
  echo: true
  warning: false
  error: false
  cache: false
---

```{r}
# Ruta del archivo CSV. Cambia si está en otra ubicación.
csv_path <- "/mnt/data/s04_diabetes.csv"

# Cargar librerías
if (!requireNamespace("tidyverse", quietly = TRUE)) install.packages("tidyverse")
library(tidyverse)

# Lectura de datos
diabetes <- read_csv(csv_path)

# Vista rápida
glimpse(diabetes)

# Resumen estadístico
summary(diabetes)
```

# Pre-procesamiento

```{r}
# Verificar valores faltantes
sapply(diabetes, function(x) sum(is.na(x)))

# Tipo de variables (convertir factores si corresponde)
# Ejemplo: si hay una variable llamada 'Outcome' con 0/1
if ("Outcome" %in% names(diabetes)) {
  diabetes <- diabetes %>% mutate(Outcome = factor(Outcome, levels = c(0,1), labels = c("No","Yes")))
}

# Mostrar primeras filas
head(diabetes)
```

# Visualizaciones básicas

```{r}
# Histograma de la primera variable numérica
num_vars <- diabetes %>% select(where(is.numeric)) %>% names()
if (length(num_vars) > 0) {
  ggplot(diabetes, aes(x = .data[[num_vars[1]]])) +
    geom_histogram(bins = 30) +
    labs(x = num_vars[1], y = "Frecuencia", title = paste("Histograma de", num_vars[1]))
}
```

```{r}
# Matriz de correlación (numéricas)
if (length(num_vars) > 1) {
  cor_mat <- diabetes %>% select(all_of(num_vars)) %>% cor(use = "pairwise.complete.obs")
  print(cor_mat)
}
```

# Análisis simple: modelo predictivo (si hay variable Outcome)

```{r}
if ("Outcome" %in% names(diabetes)) {
  # Dividir entrenamiento/prueba
  set.seed(123)
  train_idx <- sample(seq_len(nrow(diabetes)), size = 0.7 * nrow(diabetes))
  train <- diabetes[train_idx, ]
  test  <- diabetes[-train_idx, ]

  # Modelo de regresión logística con las variables numéricas
  formula_vars <- paste(num_vars[num_vars != "Outcome"], collapse = " + ")
  # Si Outcome está en num_vars, eliminarlo
  formula_vars <- paste(setdiff(num_vars, "Outcome"), collapse = " + ")
  glm_formula <- as.formula(paste("Outcome ~", formula_vars))

  model <- glm(glm_formula, data = train, family = binomial)
  summary(model)

  # Predicciones y tabla de confusión
  probs <- predict(model, newdata = test, type = "response")
  preds <- factor(ifelse(probs > 0.5, "Yes", "No"), levels = c("No","Yes"))
  truth <- test$Outcome
  table(Predicted = preds, Actual = truth)
}
```

# Notas finales

Este documento Quarto carga el archivo `s04_diabetes.csv`, realiza un resumen exploratorio,
crea visualizaciones básicas y (si existe la variable `Outcome`) ajusta un modelo de regresión logística
con una partición entrenamiento/prueba.

Ajusta las secciones de preprocesamiento y modelado según las columnas reales de tu dataset.
