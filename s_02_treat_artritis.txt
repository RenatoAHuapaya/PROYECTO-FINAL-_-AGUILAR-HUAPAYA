---
title: "Análisis de s02_treat_artritis"
author: "Generado por ChatGPT"
date: "`r Sys.Date()`"
format: html
execute:
  echo: true
  warning: false
  error: false
  cache: false
---

```{r}
# Ruta del archivo CSV
csv_path <- "/mnt/data/s02_treat_artritis.csv"

# Cargar librerías
if (!requireNamespace("tidyverse", quietly = TRUE)) install.packages("tidyverse")
library(tidyverse)

# Lectura de datos
artritis <- read_csv(csv_path)

# Vista general
glimpse(artritis)
summary(artritis)
```

# Preprocesamiento
```{r}
# Valores faltantes
sapply(artritis, \(x) sum(is.na(x)))

# Identificar variables numéricas y categóricas
num_vars <- artritis %>% select(where(is.numeric)) %>% names()
cat_vars <- artritis %>% select(where(is.character)) %>% names()

head(artritis)
```

# Visualizaciones básicas
```{r}
# Histograma de la primera variable numérica
if (length(num_vars) > 0) {
  ggplot(artritis, aes(.data[[num_vars[1]]])) +
    geom_histogram(bins = 30) +
    labs(title = paste("Histograma de", num_vars[1]), x = num_vars[1], y = "Frecuencia")
}
```

```{r}
# Correlación
if (length(num_vars) > 1) {
  cor_mat <- artritis %>% select(all_of(num_vars)) %>% cor(use = "pairwise.complete.obs")
  cor_mat
}
```

# Modelo predictivo (si existe variable de resultado)
```{r}
if ("Outcome" %in% names(artritis)) {
  artritis <- artritis %>% mutate(Outcome = factor(Outcome))

  set.seed(123)
  idx <- sample(seq_len(nrow(artritis)), size = 0.7*nrow(artritis))
  train <- artritis[idx,]
  test <- artritis[-idx,]

  formula_vars <- paste(setdiff(num_vars, "Outcome"), collapse = " + ")
  glm_formula <- as.formula(paste("Outcome ~", formula_vars))

  model <- glm(glm_formula, data = train, family = binomial)
  summary(model)

  preds <- ifelse(predict(model, newdata = test, type = "response") > 0.5, 1, 0)
  table(Predicted = preds, Actual = test$Outcome)
}
```

# Notas
Este archivo Quarto analiza el dataset `s02_treat_artritis.csv`, realiza exploración inicial,
visualizaciones básicas y modelo predictivo si corresponde. Ajusta variables según tu dataset real.